---
title: SQL 弱點評定規則參考指南
description: 規則標題和描述的清單，適用于 SQL Server、Azure SQL Database、Azure SQL 受控執行個體和 Azure Synapse Analytics
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.topic: reference
author: barmichal
ms.author: mibar
ms.reviewer: vanto
ms.date: 12/14/2020
ms.openlocfilehash: aa14c8e4d22f5eb965e9d7960bced8029b7636ea
ms.sourcegitcommit: cc13f3fc9b8d309986409276b48ffb77953f4458
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/14/2020
ms.locfileid: "97401246"
---
# <a name="sql-vulnerability-assessment-rules-reference-guide"></a>SQL 弱點評定規則參考指南
[!INCLUDE[appliesto-sqldb-sqlmi-asa](../includes/appliesto-sqldb-sqlmi-asa.md)]

本文列出一組內建規則，這些規則可用來標示安全性弱點，並醒目提示與最佳作法的偏差，例如錯誤設定、過多的許可權，以及未受保護的敏感性資料。 這些規則是以 Microsoft 的最佳作法為基礎，並且著重于對資料庫和其重要資料造成最大風險的安全性問題。 它們涵蓋了資料庫層級的問題以及伺服器層級的安全性問題，例如伺服器防火牆設定和伺服器層級權限。 這些規則也代表各種不同管理機構要符合其合規性標準的要求。

您資料庫掃描中所顯示的規則取決於已掃描的 SQL 版本和平臺。 

若要瞭解如何在 Azure 中執行弱點評定，請參閱 [執行弱點評定](./sql-vulnerability-assessment.md#implement-vulnerability-assessment)。

如需這些規則的變更清單，請參閱 [SQL 弱點評定規則變更記錄](sql-database-vulnerability-assessment-rules-changelog.md)。

## <a name="rule-categories"></a>規則類別

SQL 弱點評定規則有五個類別，如下列各節所示：

- [驗證和授權](#authentication-and-authorization)
- [審核和記錄](#auditing-and-logging)
- [資料保護](#data-protection)
- [安裝更新和修補程式](#installation-updates-and-patches)
- [縮小介面區](#surface-area-reduction)

<sup>1</sup> **SQL Server 2012 +** 指的是 SQL Server 2012 和更新版本的所有版本。

<sup>2</sup> **SQL Server 2017 +** 指的是 SQL Server 2017 和更新版本的所有版本。

<sup>3</sup> **SQL Server 2016 +** 指的是 SQL Server 2016 和更新版本的所有版本。

## <a name="authentication-and-authorization"></a>驗證和授權

|規則識別碼  |規則標題   |規則嚴重性  |規則描述  |平台  |
|---------|---------|---------|---------|---------|
| VA1017     |所有使用者 (的 xp_cmdshell 執行許可權，但必須撤銷 dbo) 以外的所有使用者          |高         |Xp_cmdshell 擴充預存程式會產生 Windows 命令 shell，並傳入要執行的字串。 這項規則會檢查除了具有 CONTROL SERVER 許可權的使用者以外的使用者 (是否擁有執行 xp_cmdshell 擴充預存程式的許可權) 。         |<nobr>SQL Server 2012 +<sup>1</sup><nobr/>         |
|VA1020     |資料庫使用者來賓不應為任何角色的成員          |高         |來賓使用者可針對未對應至特定資料庫使用者的任何登入，允許存取資料庫。 此規則會檢查是否未將任何資料庫角色指派給來賓使用者。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1042     |除了 `master` 、和以外，所有資料庫都應該停用資料庫擁有權連結 `msdb``tempdb`          |高         |跨資料庫擁有權的連結是擁有權連結的延伸模組，但它會跨越資料庫界限。 這項規則會檢查除了、和以外的所有資料庫是否已停用此選項 `master` `msdb` `tempdb` 。 針對 `master` 、 `msdb` 和 `tempdb` ，預設會啟用跨資料庫擁有權鏈。        |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1043     |主體來賓不應具有任何使用者資料庫的存取權          |中         |來賓使用者可針對未對應至特定資料庫使用者的任何登入，允許存取資料庫。 此規則會檢查來賓使用者是否無法連接到任何資料庫。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體        |
|VA1046     |所有 SQL 登入都應啟用 CHECK_POLICY          |低         |CHECK_POLICY 選項可讓您根據網域原則驗證 SQL 登入。 此規則會檢查是否已針對所有 SQL 登入啟用 CHECK_POLICY 選項。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1047     |所有 SQL 登入都應啟用密碼到期檢查          |低         |密碼過期原則用於管理密碼的壽命。 當 SQL Server 強制執行密碼到期原則時，系統會提醒使用者變更舊密碼，且已停用已過期密碼的帳戶。 此規則會檢查是否已針對所有 SQL 登入啟用密碼到期原則。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1048     |資料庫主體不應對應至 `sa` 帳戶          |高         |攻擊者可以利用對應到帳戶的資料庫主體，將 `sa` 許可權提升至 `sysadmin`         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1052     |以伺服器登入的形式移除 BUILTIN\Administrators          |低         |BUILTIN\Administrators 群組包含 Windows 本機系統管理員群組。 在舊版 Microsoft SQL Server 此群組預設會具有系統管理員許可權。 此規則會檢查是否已從 SQL Server 移除此群組。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1053     |`sa`應重新命名或停用具有預設名稱的帳戶          |低         |`sa` 是知名的帳戶，其主體識別碼為1。 此規則 `sa` 會確認帳戶已重新命名或停用。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1054     |不應將過多的許可權授與物件或資料行上的 PUBLIC 角色          |低         |每個 SQL Server 登入都屬於 public 伺服器角色。 當伺服器主體未被授與或拒絕安全物件的特定許可權時，使用者會繼承授與該物件之 public 的許可權。 此規則會顯示所有使用者透過 PUBLIC 角色可存取的所有安全物件或資料行的清單。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1058     |`sa` 應停用登入          |高         |`sa` 是知名的帳戶，其主體識別碼為1。 此規則 `sa` 會確認帳戶已停用。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1059     |應停用 xp_cmdshell          |高         |xp_cmdshell 會產生 Windows 命令 shell，並將字串傳遞給它以供執行。 此規則會檢查 xp_cmdshell 是否已停用。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1067     |當 Database Mail XPs 未使用時，應予以停用          |中         |當沒有設定 Database Mail 設定檔時，此規則會檢查 Database Mail 是否已停用。 Database Mail 可以用來傳送 SQL Server 資料庫引擎的電子郵件訊息，而且預設為停用。 如果您未使用這項功能，建議您將其停用，以減少介面區。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1068     |不應直接授與伺服器許可權給主體          |低         |伺服器層級許可權與伺服器層級物件相關聯，以控制哪些使用者可以取得物件的存取權。 此規則會檢查沒有直接授與登入的伺服器層級許可權。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1070     |資料庫使用者不應與伺服器登入共用相同的名稱          |低         |資料庫使用者可以共用與伺服器登入相同的名稱。 此規則會驗證沒有這類使用者。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1072     |驗證模式應該是 Windows 驗證          |中         |有兩種可能的驗證模式： Windows 驗證模式和混合模式。 混合模式表示 SQL Server 可同時啟用 Windows 驗證和 SQL Server 驗證。 這項規則會檢查驗證模式是否設定為 [Windows 驗證]。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1094     |不應直接授與資料庫許可權給主體          |低         |許可權是與安全物件相關聯的規則，可控制哪些使用者可以取得物件的存取權。 此規則會檢查是否有直接授與使用者的 DB 許可權。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1095     |不應將過多的許可權授與 PUBLIC role          |中         |每個 SQL Server 登入都屬於 public 伺服器角色。 當伺服器主體未被授與或拒絕安全物件的特定許可權時，使用者會繼承授與該物件之 public 的許可權。 這會顯示授與 PUBLIC 角色之擁有權限的清單。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1096     |主體來賓不應被授與資料庫的許可權          |低         |每個資料庫都包含一個稱為「來賓」的使用者。 授與 GUEST 的許可權是由具有資料庫存取權但在資料庫中沒有使用者帳戶的使用者所繼承。 此規則會檢查是否已撤銷來賓使用者的擁有權限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1097     |主體來賓不應被授與物件或資料行的許可權          |低         |每個資料庫都包含一個稱為「來賓」的使用者。 授與 GUEST 的許可權是由具有資料庫存取權但在資料庫中沒有使用者帳戶的使用者所繼承。 此規則會檢查是否已撤銷來賓使用者的擁有權限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1099     |不應將資料庫安全性實體的許可權授與來賓使用者          |低         |每個資料庫都包含一個稱為「來賓」的使用者。 授與 GUEST 的許可權是由具有資料庫存取權但在資料庫中沒有使用者帳戶的使用者所繼承。 此規則會檢查是否已撤銷來賓使用者的擁有權限。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1246     |不應使用應用程式角色          |低         |應用程式角色是一種資料庫主體，可讓應用程式以自己的類似使用者的許可權執行。 應用程式角色可讓只有透過特定應用程式連接的使用者可以存取特定資料。 應用程式角色是以密碼為基礎的 (應用程式通常會將) 硬式編碼，而不是以密碼猜測向應用程式角色模擬公開資料庫的許可權。 此規則會檢查資料庫中是否未定義任何應用程式角色。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體<br/><br/>SQL Database         |
|VA1248     |使用者定義資料庫角色不應為固定角色的成員          |中         |為了輕鬆管理資料庫中的許可權 SQL Server 提供數個角色，也就是群組其他主體的安全性主體。 它們就像是 Microsoft Windows 作業系統中的群組。 您可以將資料庫帳戶和其他 SQL Server 角色加入資料庫層級角色中。 固定資料庫角色的每個成員可以在相同的角色中加入其他使用者。 此規則會檢查使用者定義的角色是否為固定角色的成員。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1267     |包含的使用者應使用 Windows 驗證          |中         |包含的使用者是存在於資料庫中，且不需要登入對應的使用者。 此規則會檢查包含的使用者是否使用 Windows 驗證。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1280     |授與 public 的伺服器許可權應最小化          |中         |每個 SQL Server 登入都屬於 public 伺服器角色。 當伺服器主體未被授與或拒絕安全物件的特定許可權時，使用者會繼承授與該物件之 public 的許可權。 此規則會檢查授與 public 的伺服器許可權是否最小化。          |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1282     |應移除孤立角色          |低         |孤立角色是沒有成員的使用者定義角色。 排除孤立的角色，因為系統不需要它們。 此規則會檢查是否有任何孤立的角色。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2020     |應將一組基本的主體授與 ALTER 或 ALTER ANY USER database 範圍許可權          |高         |每個 SQL Server 安全性實體都有與其相關聯的許可權，可授與給主體。 許可權可以設定為伺服器層級的範圍 (指派給登入和伺服器角色) 或)  (指派給資料庫使用者和資料庫角色的資料庫層級。 這些規則會確認只有一組基本的主體被授與 ALTER 或 ALTER ANY USER database 範圍的許可權。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2033     |應對物件或資料行授與資料庫範圍的 EXECUTE 許可權的基本主體集合          |低         |這項規則會檢查哪些主體被授與物件或資料行的 EXECUTE 許可權，以確保將此許可權授與給一組基本的主體。 每個 SQL Server 安全性實體都有與其相關聯的許可權，可授與給主體。 許可權可以設定為伺服器層級的範圍 (指派給登入和伺服器角色) 或 (指派給資料庫使用者、資料庫角色或應用程式角色) 的資料庫層級。 EXECUTE 許可權適用于預存程式和純量函數，可用於計算資料行中。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2103     |應撤銷擴充預存程式上不必要的 execute 許可權          |中         |擴充預存程式是 SQL Server 實例可以動態載入和執行的 Dll。 SQL Server 封裝了許多擴充預存程式，可讓您與系統 Dll 互動。 此規則會檢查是否已撤銷擴充預存程式上不必要的 execute 許可權。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA2107     |一組基本的主體應為固定 Azure SQL DB master 資料庫角色的成員          |高         |SQL Database 在 master 資料庫中提供兩個受限制的系統管理角色，可新增使用者帳戶以授與建立資料庫或管理登入的許可權。 這項規則會檢查一組基本的主體是否為這些系統管理角色的成員。         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2108     |最基本的主體集合應為固定高影響資料庫角色的成員          |高         |SQL Server 提供可協助管理許可權的角色。 角色是分組其他主體的安全性主體。 資料庫層級角色在其許可權範圍內是整個資料庫。 這項規則會檢查一組最基本的主體是否為固定資料庫角色的成員。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2109     |最小的一組主體應為固定影響低之資料庫角色的成員          |低         |SQL Server 提供可協助管理許可權的角色。 角色是分組其他主體的安全性主體。 資料庫層級角色在其許可權範圍內是整個資料庫。 這項規則會檢查一組最基本的主體是否為固定資料庫角色的成員。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2110     |應撤銷存取登錄的執行許可權          |高         |登錄擴充預存程式可讓 Microsoft SQL Server 讀取登錄中的寫入和列舉值和金鑰。 Enterprise Manager 會使用這些設定來設定伺服器。 此規則會檢查執行登錄擴充預存程式的許可權是否已從 dbo) 以外的所有使用者 (撤銷。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA2113     |資料轉換服務 (DTS) 許可權只能授與 SSIS 角色          |中         |資料轉換服務 (DTS) 是一組物件和公用程式，可讓您在資料庫之間進行解壓縮、轉換和載入作業的自動化。 這些物件是 DTS 封裝及其元件，而公用程式稱為 DTS 工具。 此規則會檢查是否只有 SSIS 角色被授與使用 DTS 系統預存程式的許可權，而且 PUBLIC 角色的許可權已被撤銷。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA2114     |最基本的主體集合應該是高度影響固定伺服器角色的成員          |高         |SQL Server 提供可協助管理許可權的角色。 角色是分組其他主體的安全性主體。 伺服器層級角色在其許可權範圍內是全伺服器的。 這項規則會檢查一組最基本的主體是否為固定伺服器角色的成員。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA2129     |已簽署的模組變更應獲得授權          |高         |您可以使用憑證或非對稱金鑰來簽署預存程式、函數或觸發程式。 這是針對無法透過擁有權鏈結繼承權限或擁有權鏈結中斷 (例如動態 SQL) 的案例所設計。 此規則會檢查對已簽署的模組所做的變更，這可能表示惡意用途。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL Database<br/><br/>SQL 受控執行個體         |
|VA2130     |追蹤所有具有資料庫存取權的使用者          |低         |這種檢查會追蹤具有資料庫存取權的所有使用者。 請確定這些使用者已根據其目前在組織中的角色獲得授權。         |<nobr>SQL Database<nobr/><br/><br/>Azure Synapse         |

## <a name="auditing-and-logging"></a>審核和記錄

|規則識別碼  |規則標題  |規則嚴重性  |規則描述  |平台  |
|---------|---------|---------|---------|---------|
|VA1045     |應啟用預設追蹤          |中         |預設追蹤可為資料庫管理員提供疑難排解協助，確定他們有必要的記錄檔資料，能在問題發生的第一時間進行診斷。 此規則會檢查是否已啟用預設追蹤。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1091     |成功和失敗的登入嘗試同時進行審核 (預設追蹤) 應該在設定 [登入審核] 以追蹤登入時啟用          |低         |SQL Server 登入審核設定可讓系統管理員追蹤登入 SQL Server 實例的使用者。 如果使用者選擇計數「登入審核」以追蹤登入 SQL Server 實例的使用者，則將其啟用成功和失敗的登入嘗試都是很重要的。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1093     |錯誤記錄檔的最大數目應為12或更多          |低         |每個 SQL Server 錯誤記錄檔都會有所有與失敗/錯誤相關的資訊，這些資訊是自上次重新開機 SQL Server 之後，或自從您上次回收錯誤記錄檔以來發生的。 這項規則會檢查錯誤記錄檔的最大數目是否為12個以上。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1258     |資料庫擁有者如預期般          |高         |資料庫擁有者可以在資料庫上執行所有的設定和維護活動，也可以卸載 SQL Server 中的資料庫。 追蹤資料庫擁有者很重要，可避免某些主體擁有過多許可權。 建立基準，以定義資料庫的預期資料庫擁有者。 此規則會檢查資料庫擁有者是否如基準中所定義。         |<nobr>SQL Server 2016 +<sup>3</sup><nobr/><br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1264     |應啟用成功和失敗登入嘗試的同時進行審核          |低         |SQL Server 審核設定可讓系統管理員追蹤使用者登入其負責的 SQL Server 實例。 這項規則會檢查是否已針對成功和失敗的登入嘗試啟用審核。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1265     |應啟用針對自主 DB 驗證成功與失敗登入嘗試的同時進行審核          |中         |SQL Server 審核設定可讓系統管理員追蹤使用者記錄至他們負責的 SQL Server 實例。 這項規則會檢查是否已針對自主 DB 驗證成功和失敗的登入嘗試啟用審核。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1281     |應針對使用者定義角色的所有成員資格          |中         |使用者定義角色是由使用者定義的安全性主體，用來將主體分組，以輕鬆地管理許可權。 監視這些角色是避免擁有過多許可權的重要。 建立基準，以定義每個使用者定義角色的預期成員資格。 此規則會檢查使用者定義角色的所有成員資格是否如基準中所定義。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1283     |系統中至少應有1個主動審核          |低         |稽核 SQL Server 資料庫引擎或個別資料庫的執行個體，會牽涉到追蹤和記錄資料庫引擎中所發生之事件。 SQL Server Audit 物件會收集要監視之伺服器或資料庫層級動作和動作群組的單一執行個體。 這項規則會檢查系統中是否至少有一個作用中的 audit。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA2061     |應在伺服器層級啟用審核          |高         |Azure SQL Database 審核會追蹤資料庫事件，並將其寫入 Azure 儲存體帳戶中的 audit 記錄檔。 「審核」可協助您瞭解資料庫活動，以及深入瞭解可能指出商務疑慮或可疑安全性違規的不一致和異常，並協助您符合法規合規性。 如需詳細資訊，請參閱 [AZURE SQL 審查](https://docs.microsoft.com/azure/sql-database/sql-database-auditing)。 此規則會檢查是否已啟用審核。         |<nobr/>SQL Database<br/><br/>Azure Synapse          |

## <a name="data-protection"></a>資料保護

|規則識別碼  |規則標題  |規則嚴重性  |規則描述  |平台  |
|---------|---------|---------|---------|---------|
|VA1098     |任何現有的 SSB 或鏡像端點都應需要 AES 連接          |高         |Service Broker 和鏡像端點支援不同的加密演算法，包括不加密。 此規則會檢查是否有任何現有的端點需要 AES 加密。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1219     |應啟用透明資料加密          |中         |透明資料加密 (TDE) 可針對資料庫、相關聯的備份和交易記錄檔執行即時加密和解密，而不需要變更應用程式，以協助保護資料庫檔案免于洩漏資訊。 此規則會檢查資料庫上是否已啟用 TDE。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1220     |使用 TDS 的資料庫通訊應該透過 TLS 來保護          |高         |Microsoft SQL Server 可以使用安全通訊端層 (SSL) 或傳輸層安全性 (TLS) ，加密在 SQL Server 實例和用戶端應用程式之間透過網路傳輸的資料。 此規則會檢查 SQL Server 的所有連接都是透過 TLS 加密。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1221     |資料庫加密對稱金鑰應使用 AES 演算法          |高         |SQL Server 使用加密金鑰來協助保護儲存在伺服器資料庫中的資料認證和連接資訊。 SQL Server 有兩種類型的金鑰：對稱和非對稱。 此規則會檢查資料庫加密對稱金鑰是否使用 AES 演算法。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1222     |Cell-Level 加密金鑰應使用 AES 演算法          |高         |Cell-Level Encryption (CLE) 可讓您使用對稱和非對稱金鑰來加密您的資料。 此規則會檢查 Cell-Level 加密對稱金鑰是否使用 AES 演算法。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1223     |憑證金鑰至少應使用2048位          |高         |憑證金鑰用於 RSA 和其他加密演算法，以保護資料。 這些金鑰必須有足夠的長度，才能保護使用者的資料。 此規則會檢查所有憑證的金鑰長度至少為2048位。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1224     |非對稱金鑰的長度至少應為2048位          |高         |資料庫非對稱金鑰用於許多加密演算法中，這些金鑰必須有足夠的長度，以保護加密的資料。此規則會檢查儲存在資料庫中的所有非對稱金鑰長度是否至少為2048位         |<nobr>SQL Server 2012<nobr/><br/><br/><nobr>SQL Server 2014<nobr/><br/><br/>SQL Database         |
|VA1279     |應為 TDS 啟用強制加密          |高         |啟用資料庫引擎的 [強制加密] 選項時，用戶端與伺服器之間的所有通訊都會加密，不論是否已核取 [加密連線] 選項 (（例如從 SSMS) ）。 此規則會檢查是否已啟用 [強制加密] 選項。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1288     |應將機密資料行分類          |中         |此規則會檢查掃描的資料庫是否有可能已分類的機密資料。         |<nobr/>SQL Database         |
|VA2060     |應在伺服器層級啟用 SQL 威脅偵測          |中         |SQL 威脅偵測會提供一層安全性，以偵測資料庫中的潛在弱點和異常活動，例如 SQL 插入式攻擊和異常行為模式。 偵測到潛在威脅時，威脅偵測會透過電子郵件和 Azure 資訊安全中心傳送可操作的即時警示，包括明確的調查和特定威脅的補救步驟。 如需詳細資訊，請參閱 [設定威脅偵測](https://docs.microsoft.com/azure/sql-database/sql-database-threat-detection)。 這項檢查會確認是否已啟用 SQL 威脅偵測         |<nobr/><br/>SQL 受控執行個體<br/><br/>SQL Database<br/><br/>Azure Synapse         |

## <a name="installation-updates-and-patches"></a>安裝更新和修補程式

|規則識別碼  |規則標題  |規則嚴重性  |規則描述  |平台  |
|---------|---------|---------|---------|---------|
| VA1018     |應安裝最新的更新          |高         |Microsoft 會定期發行每個 SQL Server 版本的累積更新 (Cu) 。 此規則會藉由傳入要執行的字串，檢查是否已針對所使用的特定 SQL Server 版本安裝最新的 CU。 此規則會檢查除了 dbo) 以外的所有 (使用者都沒有執行 xp_cmdshell 擴充預存程式的許可權。 |<nobr>SQL Server 2005<nobr/><br/><br/><nobr>SQL Server 2008<nobr/><br/><br/><nobr>SQL Server 2008<nobr/><br/><br/><nobr>SQL Server 2012<nobr/><br/><br/><nobr>SQL Server 2014<nobr/><br/><br/><nobr>SQL Server 2016<nobr/><br/><br/>SQL Server 2017<br/>|
|VA2128     |SQL Server 低於 SQL Server 2012 的版本不支援弱點評定          |高         |若要在您的 SQL Server 上執行弱點評定掃描，您必須將伺服器升級為 SQL Server 2012 或更高版本，Microsoft 將不再支援 SQL Server 2008 R2 和更新版本。 如需詳細資訊，請參閱<https://www.microsoft.com/cloud-platform/windows-sql-server-2008>。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體<br/><br/>SQL Database<br/><br/>Azure Synapse         |

## <a name="surface-area-reduction"></a>縮小介面區

|規則識別碼  |規則標題  |規則嚴重性  |規則描述  |平台  |
|---------|---------|---------|---------|---------|
|VA1022     |應停用特定分散式查詢          |中         |臨機操作分散式查詢 `OPENROWSET` 會使用和 `OPENDATASOURCE` 函數連接到使用 OLE DB 的遠端資料源。 此規則會檢查特定分散式查詢是否已停用。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1023     |應停用 CLR          |高         |CLR 可讓您裝載 managed 程式碼，並在 Microsoft SQL Server 環境中執行。 此規則會檢查 CLR 是否已停用。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1026     |應停用 CLR          |中         |CLR 可讓您裝載 managed 程式碼，並在 Microsoft SQL Server 環境中執行。 CLR 嚴格安全性會將安全和 EXTERNAL_ACCESS 的元件視為不安全的元件，並且要求所有的元件都是由憑證或非對稱金鑰簽署，且具有在 master 資料庫中被授與 UNSAFE ASSEMBLY 許可權的對應登入。 此規則會檢查 CLR 是否已停用。         |<nobr>SQL Server 2017 +<sup>2</sup><nobr/><br/><br/>SQL 受控執行個體         |
|VA1027     |應移除未追蹤的受信任元件          |高         |標記為 UNSAFE 的元件必須以憑證或非對稱金鑰簽署，且具有在 master 資料庫中被授與 UNSAFE ASSEMBLY 許可權的對應登入。 受信任的元件可能會略過這項需求。          |<nobr>SQL Server 2017 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1044     |除非特別需要，否則應停用遠端系統管理連接          |中         |此規則會檢查遠端專用管理員連線是否已停用，因為它們不會用於叢集，以減少受攻擊的介面區。 SQL Server 提供 (DAC) 的專用管理員連接。 DAC 可讓系統管理員存取執行中的伺服器，以執行診斷函數或 Transact-sql 語句，或針對伺服器上的問題進行疑難排解，並在遠端啟用時變成吸引人的攻擊目標。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1051     |應該在所有資料庫上停用 AUTO_CLOSE          |中         |AUTO_CLOSE 選項會指定資料庫是否正常關機，並在最後一個使用者中斷連線後釋出資源。 無論其優點為何，都可能會主動開啟和關閉資料庫來導致阻絕服務，因此請務必停用此功能。 這項規則會檢查目前資料庫上的這個選項是否已停用。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1066     |應移除未使用的 service broker 端點          |低         |Service Broker 為 SQL Server 提供佇列和可靠的訊息處理。 針對使用單一 SQL Server 實例的應用程式，以及跨多個實例散發工作的應用程式，都可以使用 Service Broker。 Service Broker 端點提供了傳輸安全性和訊息轉送的選項， 此規則會列舉所有 service broker 端點。 移除未使用的那些。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1071     |應停用 [掃描啟動預存程式] 選項          |中         |啟用 [掃描啟動程式] 時 SQL Server 會掃描並執行伺服器上定義的所有自動執行預存程式。 如果啟用此選項 SQL Server 會掃描並執行伺服器上定義的所有自動執行預存程式。 此規則會檢查是否已停用此選項。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1092     |SQL Server 實例不應由 SQL Server Browser 服務公告          |低         |SQL Server 使用 SQL Server Browser 服務來列舉電腦上所安裝資料庫引擎的實例。 這可讓用戶端應用程式流覽伺服器，並協助用戶端區分同一部電腦上資料庫引擎的多個實例。 這項規則會檢查 SQL 實例是否已隱藏。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1102     |在 MSDB 以外的所有資料庫上，都應該停用信任位          |高         |[可信任的資料庫] 屬性是用來指出 SQL Server 的實例是否信任資料庫及其內容。 如果啟用此選項，則會使用資料庫模組 (例如，使用模擬內容的使用者定義函數或預存程式) 可存取資料庫之外的資源。 此規則會確認 MSDB 以外的所有資料庫上的可信任位已停用。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1143     |' dbo ' 使用者不應用於正常服務作業          |中         |' Dbo ' 或資料庫擁有者是具有隱含許可權可執行資料庫中所有活動的使用者帳戶。 系統管理員（sysadmin）固定伺服器角色的成員會自動對應到 dbo。 這項規則會檢查 dbo 是否不是唯一允許存取此資料庫的帳戶。 請注意，在新建立的全新資料庫上，在建立其他角色之前，此規則將會失敗。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1144     |模型資料庫只能由 ' dbo ' 存取          |中         |Model 資料庫會當做 SQL Server 實例上建立之所有資料庫的範本使用。 對模型資料庫所做的修改（例如資料庫大小復原模式和其他資料庫選項）會套用至之後建立的任何資料庫。 這項規則會檢查 dbo 是否為唯一允許存取模型資料庫的帳戶。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1230     |應停用 Filestream          |高         |FILESTREAM 將 SQL Server 資料庫引擎與 NTFS 檔案系統整合，方法是將 Varbinary (max) 二進位大型物件 (BLOB) 資料儲存為檔案系統上的檔案。 Transact-sql 語句可以插入、更新、查詢、搜尋和備份 FILESTREAM 資料。 在 SQL server 上啟用 Filestream 會公開其他的 NTFS 串流 API，以增加其受攻擊面，並使其容易遭受惡意攻擊。 此規則會檢查 Filestream 是否已停用。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1235     |應停用伺服器設定 ' Replication XPs '          |中         |停用已被取代的伺服器設定 ' Replication XPs '，以限制受攻擊的介面區。 這是僅供內部使用的設定。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1244     |應從 SQL server 資料庫移除孤立的使用者          |中         |資料庫使用者存在於資料庫中，但在 master 資料庫中沒有對應的登入，或做為外部資源 (例如，Windows 使用者) 稱為孤立的使用者，應該移除或重新對應到有效的登入。 此規則會檢查沒有任何孤立的使用者。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1245     |目標 DB 和 master 之間的 dbo 資訊應該一致          |高         |任何資料庫的 dbo 身分識別都會有多餘的資訊：儲存在資料庫本身的中繼資料，以及儲存在 master DB 中的中繼資料。 此規則會檢查目標 DB 和 master 之間的這項資訊是否一致。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1247     |應該沒有任何 SPs 標示為自動啟動          |高         |當 SQL Server 設定為 [掃描啟動程式] 時，伺服器會掃描 master DB 中標示為自動啟動的預存程式。 此規則會檢查沒有任何 SPs 標示為自動啟動。         |<nobr>SQL Server 2012 +<nobr/>         |
|VA1256     |不應該在資料庫中定義使用者 CLR 元件          |高         |CLR 元件可以用來在 SQL Server 進程上執行任意程式碼。 這項規則會檢查資料庫中是否沒有任何使用者定義的 CLR 元件。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA1277     |應啟用 Polybase 網路加密          |高         |PolyBase 是一種技術，可從 SQL Server 記憶體取並結合非關聯式和關聯式資料。 Polybase 網路加密選項會設定 SQL Server，以在使用 Polybase 時加密控制和資料通道。 此規則會確認是否已啟用此選項。         |<nobr>SQL Server 2016 +<nobr/>         |
|VA1278     |建立外部金鑰管理提供者的基準          |中         |SQL Server 可延伸金鑰管理 (EKM) 可讓協力廠商 EKM/硬體安全性模組 (HSM) 廠商在 SQL Server 中註冊其模組。 當註冊 SQL Server 使用者可以使用儲存在 EKM 模組上的加密金鑰時，此規則會顯示系統中所使用之 EKM 提供者的清單。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA2062     |資料庫層級防火牆規則不應授與過多的存取權          |高         |Azure SQL Database 層級防火牆會防止對您的資料庫進行所有存取，直到您指定哪些 IP 位址擁有許可權，以協助保護您的資料。 資料庫層級防火牆規則會根據每個要求的原始 IP 位址，授與特定資料庫的存取權。 Master 和使用者資料庫的資料庫層級防火牆規則只能透過 Transact-sql (建立和管理，與伺服器層級防火牆規則不同，您也可以使用 Azure 入口網站或 PowerShell) 來建立和管理這些規則。 如需詳細資訊，請參閱 [Azure SQL Database 和 AZURE SYNAPSE ANALYTICS IP 防火牆規則](https://docs.microsoft.com/azure/sql-database/sql-database-firewall-configure)。 此檢查會確認資料庫層級防火牆規則不會授與超過255個 IP 位址的存取權。         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2063     |伺服器層級防火牆規則不應授與過多的存取權          |高         |Azure SQL server 層級防火牆會防止對您的資料庫進行所有存取，直到您指定哪些 IP 位址擁有許可權，以協助保護您的伺服器。 伺服器層級防火牆規則會根據每個要求的原始 IP 位址，授與屬於伺服器的所有資料庫的存取權。  伺服器層級防火牆規則只能透過 Transact-sql 以及透過 Azure 入口網站或 PowerShell 來建立和管理。 如需詳細資訊，請參閱 [Azure SQL Database 和 AZURE SYNAPSE ANALYTICS IP 防火牆規則](https://docs.microsoft.com/azure/sql-database/sql-database-firewall-configure)。 此檢查會確認伺服器層級防火牆規則未授與超過255個 IP 位址的存取權。         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2064     |應嚴格追蹤和維護資料庫層級防火牆規則          |高         |Azure SQL Database 層級防火牆會防止對您的資料庫進行所有存取，直到您指定哪些 IP 位址擁有許可權，以協助保護您的資料。 資料庫層級防火牆規則會根據每個要求的原始 IP 位址，授與特定資料庫的存取權。 Master 和使用者資料庫的資料庫層級防火牆規則只能透過 Transact-sql (建立和管理，與伺服器層級防火牆規則不同，您也可以使用 Azure 入口網站或 PowerShell) 來建立和管理這些規則。 如需詳細資訊，請參閱 [Azure SQL Database 和 AZURE SYNAPSE ANALYTICS IP 防火牆規則](https://docs.microsoft.com/azure/sql-database/sql-database-firewall-configure)。 這種檢查會列舉所有資料庫層級的防火牆規則，以便識別和處理對它們所做的任何變更。         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2065     |伺服器層級防火牆規則應以嚴格的最小值進行追蹤和維護          |高         |Azure SQL server 層級防火牆會防止對您的資料庫進行所有存取，直到您指定哪些 IP 位址擁有許可權，以協助保護您的資料。 伺服器層級防火牆規則會根據每個要求的原始 IP 位址，授與屬於伺服器的所有資料庫的存取權。  您可以透過 Transact-sql 以及透過 Azure 入口網站或 PowerShell 來建立和管理伺服器層級防火牆規則。 如需詳細資訊，請參閱 [Azure SQL Database 和 AZURE SYNAPSE ANALYTICS IP 防火牆規則](https://docs.microsoft.com/azure/sql-database/sql-database-firewall-configure)。  這種檢查會列舉所有伺服器層級的防火牆規則，以便識別和處理對它們所做的任何變更。         |<nobr/>SQL Database<br/><br/>Azure Synapse         |
|VA2111     |應移除範例資料庫          |低         |Microsoft SQL Server 隨附了數個範例資料庫。 此規則會檢查是否已移除範例資料庫。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA2120     |應停用可能影響安全性的功能          |高         |SQL Server 能夠提供各式各樣的功能和服務。 預設提供的部分功能和服務可能不是必要的，而啟用它們可能會對系統的安全性造成負面影響。 這項規則會檢查是否已停用這些功能。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA2121     | 應停用 [OLE Automation 程式] 功能         |高         |SQL Server 能夠提供各式各樣的功能和服務。 某些功能和服務（預設提供）可能不是必要的，而啟用它們可能會對系統的安全性造成負面影響。 [OLE Automation 程式] 選項會控制是否可以在 Transact-sql 批次內具現化 OLE Automation 物件。 這些是擴充預存程式，可讓 SQL Server 的使用者在 SQL Server 外部執行函數。 無論其優點為何，它也可以用來進行入侵，也就是在目的電腦上用來植入檔案的常用機制。 建議您使用 PowerShell 作為此工具的替代方案。 此規則會檢查 [OLE Automation 程式] 功能是否已停用。          |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA2122     |應停用 [使用者選項] 功能          |中         |SQL Server 能夠提供各式各樣的功能和服務。 預設提供的部分功能和服務可能不是必要的，而啟用它們可能會對系統的安全性造成負面影響。 使用者選項指定所有使用者的全域預設值。 會為使用者工作階段的持續時間建立預設查詢處理選項的清單。 如果伺服器的預設設定不適合) ，使用者選項可讓您變更 SET 選項 (的預設值。 此規則會檢查 [使用者選項] 功能是否已停用。         |<nobr>SQL Server 2012 +<nobr/><br/><br/>SQL 受控執行個體         |
|VA2126     |擴充功能-如果不需要，則應該停用可能會影響安全性的功能          |中         |SQL Server 提供各式各樣的功能和服務。 某些功能和服務（預設提供）可能不是必要的，而啟用它們可能會對系統的安全性造成負面影響。 這項規則會檢查允許將資料解壓縮至外部資料源的設定，以及已停用特定遠端語言延伸模組的腳本執行。         |<nobr>SQL Server 2016 +<nobr/>         |

## <a name="removed-rules"></a>已移除規則

|規則識別碼  |規則標題  |
|---------|---------|
|VA1021     |應移除全域暫存預存程序         |
|VA1024    |應啟用 C2 稽核模式 |
|VA1069     |從系統資料表和 views 選取的許可權應從非系統管理員撤銷         |
|VA1090    |確認 (GOTS) 和自訂預存程式的所有政府都已加密 |
|VA1103    |僅使用具有 SAFE_ACCESS 許可權的 CLR |
|VA1229     |登錄和 SQL Server 設定中的 Filestream 設定應該相符         |
|VA1231     | (SQL) 應該停用 Filestream         |
|VA1234     |應啟用通用準則設定         |
|VA1252     |透過伺服器審核規格進行審核和集中管理的事件清單。         |
|VA1253     |透過伺服器審核規格進行審核及集中管理的資料庫範圍事件清單         |
|VA1263     |列出系統中的所有主動審核         |
|VA1266     |必須在所有 SQL 登入上設定 ' MUST_CHANGE ' 選項         |
|VA1276     |應停用 Agent XPs 功能         |
|VA1286     |資料庫許可權不應直接授與主體 (物件或資料行)          |
|VA2000     |最基本的主體集合應獲得對資料庫範圍許可權的高度影響         |
|VA2001     |最基本的主體集合應該被授與對物件或資料行的高度影響資料庫範圍許可權         |
|VA2002     |在各種安全性實體上，最基本的主體集合應該被授與高度影響資料庫範圍的許可權         |
|VA2010     |應授與基本的主體集合，並授與資料庫範圍許可權的中等影響         |
|VA2021     |應將物件或資料行的資料庫範圍 ALTER 許可權授與一組基本的主體         |
|VA2022     |應將各種安全性實體的資料庫範圍 ALTER 許可權授與一組基本的主體         |
|VA2030     |應將一組基本的主體授與資料庫範圍的 SELECT 或 EXECUTE 許可權         |
|VA2031     |應將一組基本的主體授與資料庫範圍的 SELECT          |
|VA2032     |應授與基本的主體集合，並授與架構的資料庫範圍 SELECT 或 EXECUTE 許可權         |
|VA2034     |應授與基本的主體集合，以取得 XML 架構集合上資料庫範圍的 EXECUTE 許可權         |
|VA2040     |最少的主體集合應授與對資料庫範圍許可權的低影響力         |
|VA2041     |最少的主體集合應授與對物件或資料行的低影響資料庫範圍許可權         |
|VA2042     |在架構上，最少的主體集合應授與對資料庫範圍許可權的低影響力         |
|VA2050     |一組基本的主體應獲得資料庫範圍的 VIEW DEFINITION 許可權         |
|VA2051     |應將物件或資料行的資料庫範圍 VIEW DEFINITION 許可權授與基本的主體集合         |
|VA2052     |應該在各種安全性實體上授與一組基本的主體定義許可權         |
|VA2100     |最基本的主體集合應該被授與高度影響伺服器範圍的許可權         |
|VA2101     |應將基本的主體集合授與伺服器範圍許可權的中等影響力         |
|VA2102     |最少的主體集合應授與低影響力的伺服器範圍許可權         |
|VA2104     |擴充預存程式的 Execute 許可權應從 PUBLIC 撤銷         |
|VA2105     |不要輕易猜出登入密碼         |
|VA2112     |應該撤銷資料轉換服務 (DTS) 的公用許可權         |
|VA2115     |一組基本的主體應該是中度影響固定伺服器角色的成員         |
|VA2123     |應停用 [遠端存取] 功能         |
|VA2127     |應停用「外部腳本」功能         |

## <a name="next-steps"></a>後續步驟

- [弱點評定](sql-vulnerability-assessment.md)
- [SQL 弱點評定規則變更記錄](sql-database-vulnerability-assessment-rules-changelog.md)
---
title: Azure 資訊安全中心中的 BYOL VM 弱點評定
description: 在您的 Azure 虛擬機器上部署 BYOL 弱點評估解決方案，以取得可協助您保護虛擬機器 Azure 資訊安全中心中的建議。
services: security-center
documentationcenter: na
author: memildin
manager: rkarlin
ms.service: security-center
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/22/2020
ms.author: memildin
ms.openlocfilehash: 31689749b6d52abab842cf10c8a1aef707a680d9
ms.sourcegitcommit: 32c521a2ef396d121e71ba682e098092ac673b30
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/25/2020
ms.locfileid: "91301579"
---
# <a name="deploy-a-bring-your-own-license-byol-vulnerability-assessment-solution"></a>部署自備授權 (BYOL) 弱點評定解決方案

如果您已啟用 **適用于伺服器的 Azure Defender**，您將能夠使用 Azure 資訊安全中心的內建弱點評定工具，如 [虛擬機器的整合式弱點掃描器](built-in-vulnerability-assessment.md)中所述。 這項工具已整合到 Azure Defender，且不需要任何外部授權-所有專案都是在資訊安全中心內無縫處理。

或者，您可能想要從 [Qualys](https://www.qualys.com/lp/azure) 或 [Rapid7](https://www.rapid7.com/products/insightvm/)部署自己的私用授權弱點評估解決方案。 您可以在屬於相同訂用帳戶的多個 Vm 上安裝其中一個合作夥伴解決方案。

## <a name="deploy-a-byol-solution-from-the-azure-portal"></a>從 Azure 入口網站部署 BYOL 方案

BYOL 選項會參考支援的協力廠商弱點評定解決方案。 目前，Qualys 和 Rapid7 都是支援的提供者。

支援的解決方案會向合作夥伴的管理台回報弱點資料。 接著，該平台會將弱點和健康情況監視資料提供給資訊安全中心。 您可以在資訊安全中心儀表板上識別易受攻擊的 Vm，並直接從資訊安全中心切換至合作夥伴管理主控台，以取得其他報告和資訊。

1. 在 [Azure 入口網站](https://azure.microsoft.com/features/azure-portal/)中，開啟 [ **安全性中心**]。

1. 在 [安全性中心] 功能表中，開啟 [ **建議** ] 頁面。

1. 選取建議 **應在您的虛擬機器上啟用弱點評估解決方案**。

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png" alt-text="您應在虛擬機器的 [建議] 頁面上，啟用 * * 弱點評定解決方案中的機器群組" lightbox="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png":::

    您的 VM 會出現在下列一個或多個群組中：

    * **狀況良好的資源** -資訊安全中心偵測到在這些 vm 上執行的弱點評估解決方案。
    * **狀況不良的資源** -可以將弱點掃描器延伸模組部署到這些 vm。 
    * **不適用資源** -這些 vm 無法部署弱點掃描器延伸模組。

1. 從健康情況不良的電腦清單中，選取要接收弱點評定解決方案的電腦，然後選取 [ **修復**]。

    >[!IMPORTANT]
    > 視您的設定而定，您可能只會看到這份清單的子集。 
    >
    > - 如果您尚未設定協力廠商弱點掃描器，將不會提供部署的機會。
    > - 如果您選取的 Vm 未受 Azure Defender 保護，將無法使用 ASC 整合式弱點掃描器選項。

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-remediation-options.png" alt-text="回應建議時，您想要選擇哪一種補救流程類型的選項 * * 您應在虛擬機器上啟用弱點評定解決方案 * * 建議頁面":::

1. 如果您要設定新的 BYOL 設定，請選取 [ **設定新的協力廠商弱點掃描**程式]，選取 [ **繼續**]，然後輸入來自提供者的詳細資料，如下所示：

    1. 針對 [資源群組]****，選取 [使用現有的]****。
    1. 針對 [位置] ****，選取此解決方案所在的地理位置。
    1. 針對 [Qualys]，請在 [ **授權碼** ] 欄位中輸入 Qualys 提供的授權。
    1. 針對 Rapid7，上傳 **Rapid7 設定檔**。
    1. 在 [ **公開金鑰** ] 方塊中，輸入夥伴所提供的公開金鑰資訊。
    1. 若要在此解決方案的訂用帳戶中所有探索到的 Vm 上自動安裝此弱點評定代理程式，請選取 [ **自動部署**]。
    1. 選取 [確定]  。

1. 如果您已經設定 BYOL 解決方案，請選取 [ **部署已設定的協力廠商弱點掃描器**]，然後 **繼續進行**。

在目的電腦上安裝弱點評估解決方案之後，資訊安全中心會執行掃描，以偵測並找出系統和應用程式中的弱點。 第一次掃描可能需要幾個小時才能完成。 之後，它會每小時執行一次。



## <a name="deploy-a-byol-solution-using-powershell-and-the-rest-api"></a>使用 PowerShell 和 REST API 部署 BYOL 解決方案

若要以程式設計方式從 [Qualys](https://www.qualys.com/lp/azure) 或 [Rapid7](https://www.rapid7.com/products/insightvm/)部署您自己的私用授權弱點評估解決方案，請使用提供的腳本 [PowerShell > 弱點解決方案](https://github.com/Azure/Azure-Security-Center/tree/master/Powershell%20scripts/Vulnerability%20Solution)。 此腳本會使用 REST API，在 ASC 中建立新的安全性解決方案。 您將需要服務提供者提供的授權和金鑰 (Qualys 或 Rapid7) 。

> [!IMPORTANT] 
> 每個授權只能建立一個方案。 嘗試使用相同的名稱/授權/金鑰建立另一個方案將會失敗。

### <a name="prerequisites"></a>Prerequisites

必要的 PowerShell 模組：

- Install-module Az
- Install-module Az. security

### <a name="run-the-script"></a>執行指令碼

若要執行腳本，您需要下列參數的相關資訊。

| **參數** | **必要** | **備註** |
|----|:----:|----|
|**SubscriptionId**|✔|包含您想要分析之資源的 Azure 訂用帳戶 subscriptionID。|
|**resourceGroupName**|✔|資源群組的名稱。 使用任何現有的資源群組，包括預設 ( "DefaultResourceGroup-xxx" ) 。 由於解決方案不是 Azure 資源，因此它不會列在資源群組底下，但仍會附加至該資源群組。|
|**vaSolutionName**|✔|新方案的名稱。|
|**vaType**|✔|Qualys 或 Rapid7。|
|**licenceCode**|✔|廠商提供的授權字串。|
|**publicKey**|✔|廠商提供的公開金鑰。|
|**自動**|-|啟用 (true) 或停用 (false) 此 VA 解決方案的自動部署。 啟用時，訂用帳戶上的每個新 VM 都會自動嘗試連結至解決方案。<br/>(預設：False)|
||||

語法：

```azurepowershell
.\New-ASCVASolution.ps1 -subscriptionId <Subscription Id> -resourceGroupName <RG Name>
-vaSolutionName <New solution name> -vaType <Qualys / Rapid7> -autoUpdate <true/false>
-licenceCode <License code from vendor> -publicKey <Public Key received from vendor>
```

範例 (此範例不包含有效的授權詳細資料) ：

```azurepowershell
.\New-ASCVASolution.ps1 -subscriptionId 'f4cx1b69-dtgb-4ch6-6y6f-ea2e95373d3b' -resourceGroupName 'DefaultResourceGroup-WEU' -vaSolutionName 'QualysVa001' -vaType 'Qualys' -autoUpdate 'false' `
-licenceCode 'eyJjaWQiOiJkZDg5OTYzXe4iMTMzLWM4NTAtODM5FD2mZWM1N2Q3ZGU5MjgiLCJgbTYuOiIyMmM5NDg3MS1lNTVkLTQ1OGItYjhlMC03OTRhMmM3YWM1ZGQiLCJwd3NVcmwiOiJodHRwczovL3FhZ3B1YmxpYy1wMDEuaW50LnF1YWx5cy5jb20vQ2xvdSKJY6VudC8iLCJwd3NQb3J0IjoiNDQzIn0=' `
-publicKey 'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCOiOLXjOywMfLZIBGPZLwSocf1Q64GASLK9OHFEmanBl1nkJhZDrZ4YD5lM98fThYbAx1Rde2iYV1ze/wDlX4cIvFAyXuN7HbdkeIlBl6vWXEBZpUU17bOdJOUGolzEzNBhtxi/elEZLghq9Chmah82me/okGMIhJJsCiTtglVQIDAQAB'
```

## <a name="next-steps"></a>後續步驟

> [!div class="nextstepaction"]
> [補救您弱點評估解決方案的結果](remediate-vulnerability-findings-vm.md)


資訊安全中心也會為您提供弱點分析：

- SQL 資料庫 - 請參閱[探索弱點評量儀表板中的弱點評量報告](defender-for-sql-usage.md#explore-vulnerability-assessment-reports)
- Azure Container Registry 映射-請參閱 [使用適用于容器登錄的 Azure Defender 來掃描映射是否有弱點](defender-for-container-registries-usage.md)